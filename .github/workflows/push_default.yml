name: Build and push image

on:
  push:
    branches:
      - master
      - main
    paths:
      - '**.go'
      - go.mod
      - go.sum

jobs:
  docker:
    name: Build and push
    uses: skiff-sh/gh-actions/.github/workflows/build-and-push.yml@master
    secrets:
      GITHUB_TOKEN: ${{ secrets.ACTIONS_TOKEN }}
    with:
      image-description: 'A generic server app that executes defined behavior.'
      push: true
      images: |
        ghcr.io/${{ github.repository }}
      tags: |
        type=sha
        type=raw,value=latest
